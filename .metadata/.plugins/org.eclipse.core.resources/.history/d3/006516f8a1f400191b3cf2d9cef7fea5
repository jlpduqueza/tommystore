$(function() {

    $message = $('.customMessage');
    $message.hide();

    var contextPath = $(document.body).attr("data-context-path");

    $('.cartItem-table').on('click', '.modal-link', function(e) {
        $("#quantityField").val('0');
        var $id = $(this).attr("data-id");

        $.get({
            url: contextPath + '/ajax/edit-cart?id=' + $id,
            success: function(res) {

                $(".modal-body").html(editModalContent(res));
                $("#image").attr("src", contextPath + '/images/' + res.picturePath);

                $("#id").attr('value', res.id);
                $("#errorMessage").fadeOut();

            },
            error: function(error) {
                console.log(error);
                alert("There's a problem editing cart.");
            }
        });
    });

    $('#edit-form').on('click', '#buttonSubmit', function(e) {

        e.preventDefault();
        var modal = $("#edit-cart");

        $.post({
            url: contextPath + '/ajax/edit-cartitem',
            data: $('form[name="edit-cart"]').serialize(),
            success: function(res) {

                if (res.validated) {

                    $("#" + res.data.id).html(res.data.quantity);

                    modal.modal('toggle');

                    $message.attr("class", "alert alert-success customMessage").show().html(res.customMessage);

                } else {

                    $message.attr("class", "alert alert-danger customMessage").show().html(res.customMessage);
                }
            },
            error: function(error) {
                console.log(error);
                alert("There's a problem editing cart.");
            }

        })
    });

});
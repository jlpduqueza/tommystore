$(function() {

	var contextPath = $(document.body).attr("data-context-path");

	$('.addSuccessMessage').hide();

	
	$('.card-container').on('click', '.nav-link', function(e) {

	    e.preventDefault();
	    
		$("#quantityField").val('0');
		$("#errorMessage").fadeOut();
		var $id = $(this).attr("data-id");

			 $.get({
				url : contextPath+'/ajax/product?id='+$id,
				success : function(res) {
					 $('#modal-content').html(modalContent(res));

					 $("#errorMessage").fadeOut(1);
					 $("#image").attr("src", contextPath+'/images/'+res.picturePath);
		        	 $("#id").attr('value',res.id);
				}
				, error:function(error){
					console.log(error);
				}
			
			});
   });

	
	$('#add-to-cart-form').on('click', '#buttonSubmit', function(e) {
	    e.preventDefault();

	    var modal = $("#AddToCart");
  	    
	    $.post({
	       url : contextPath+'/ajax/add-to-cart',
	       data : $('form[name="addToCart"]').serialize(),
	       success : function(res) {
	       
	    	   console.log("getting here");
	          if(res.validated){
		    	  $("#errorMessage").toggle();
		    	  modal.modal('toggle');
	        	  console.log("valid");
	          
	          }else{
//	              $.each(res.errorMessages,function(key,value){
//	            	  $('input[name='+key+']').after('<span class="text-danger">'+value+'</span>');
//	              });
		    	  $("#errorMessage").html(res.customMessage);
		    	  $("#customMessage").show().html(res.customMessage);
		    	  $("#errorMessage").fadeIn();
	          }
	       }
	    , error:function(error){
	    	console.log(error);
	    }
	    
	    })
	 });
    
});
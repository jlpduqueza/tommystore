$(function() {

	var contextPath = $(document.body).attr("data-context-path");

	$('.editSuccessMessage').hide();
	
	$('.cartItem-table').on('click', '.modal-link', function(e) {
		$("#quantityField").val('0');
		var $id = $(this).attr("data-id");

			 $.get({
				url : contextPath+'/ajax/edit-category?id='+$id,
				success : function(res) {

					
					$(".modal-body").html(editModalContent(res));
		        	 $("#image").attr("src", contextPath+'/images/'+res.picturePath);

		        	 $("#id").attr('value',res.id);
		     		$("#errorMessage").fadeOut();
		        	 
				}
				, error:function(error){
					console.log(error);
				}
			
			});
   });

	$('#edit-form').on('click', '#buttonSubmit', function(e) {
		 
	    e.preventDefault();
	    var modal = $("#edit-cart");

	    $.post({
	       url : contextPath+'/ajax/edit-cartitem',
	       data : $('form[name="edit-cart"]').serialize(),
	       success : function(res) {
	       
	          if(res.validated){
		    	  $("#errorMessage").fadeOut();
		    	  $("#"+res.data.id).html(res.data.quantity);
		    	  modal.modal('toggle');
	     		  $('.editSuccessMessage').show();

	          
	          }else{
	              $.each(res.errorMessages,function(key,value){
	            	  $('input[name='+key+']').after('<span class="text-danger">'+value+'</span>');
	              });
		    	  $("#errorMessage").html(res.customMessage);
		    	  $("#errorMessage").fadeIn();
	          }
	       }
	    , error:function(error){
	    	console.log(error);
	    }
	    
	    })
	 });
    
});